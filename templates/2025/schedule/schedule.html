{% extends "base.html" %}
{% load i18n static markdown_extras %}
{% block meta_title %}{% if page %}{{ page.meta_title }}{% else %}{% trans "Schedule | PyCon Uganda 2025" %}{% endif %}{% endblock %}

{% block content %}
{% include '2025/navbar.html' %}

<!-- Breadcrumbs -->
<section class="g-bg-gray-light-v5 g-py-80 g-pt-150">
  <div class="container text-center">
    <h2 class="h2 g-color-black g-font-weight-600">Conference Schedule</h2>

    <ul class="u-list-inline">
      <li class="list-inline-item g-mr-5">
        <a class="u-link-v5 g-color-gray-dark-v1 g-color-primary--hover" href="/">Home</a>
        <i class="g-color-gray-light-v2 g-ml-5">/</i>
      </li>
      <li class="list-inline-item g-color-primary">
        <span>Schedule</span>
      </li>
    </ul>
    <br />
    <i class="fa-solid fa-calendar-alt" style="font-size: 41px;"></i>
  </div>
</section>
<!-- End Breadcrumbs -->

<!-- Schedule Section -->
<section class="g-py-80">
  <div class="container-fluid col-xl-10 col-lg-12 col-md-12 col-sm-12">
    {% if tabs %}
    
    <!-- Tab Navigation -->
    <div class="row justify-content-center mb-4">
      <div class="col-12">
        <div class="tab-navigation d-flex flex-wrap justify-content-center gap-2">
          {% for tab in tabs %}
          <button 
            class="tab-btn {% if forloop.first %}active{% endif %}"
            data-tab="{{ tab.id }}"
            onclick="switchTab('{{ tab.id }}')">
            {{ tab.label }}
          </button>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Legend -->
    <div class="row justify-content-center mb-4">
      <div class="col-12">
        <div class="legend d-flex flex-wrap justify-content-center gap-3">
          <div class="legend-item">
            <span class="legend-dot break"></span>
            <span class="legend-text">Breakfast/Lunch Break</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot django-girls"></span>
            <span class="legend-text">Django Girls</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot community"></span>
            <span class="legend-text">Community Summit</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot pyladies"></span>
            <span class="legend-text">PyLadies</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot pydata"></span>
            <span class="legend-text">PyData</span>
          </div>
          <div class="legend-item">
            <span class="legend-dot open-source"></span>
            <span class="legend-text">Open Source Sprints</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab Content -->
    <div class="tab-content-wrapper">
      {% for tab in tabs %}
      <div class="tab-content {% if forloop.first %}active{% endif %}" id="{{ tab.id }}-content">
        <div class="row">
          {% for room, sessions in tab.rooms.items %}
          <div class="col-lg-4 col-md-6 mb-4">
            <div class="room-column">
              <div class="room-header">
                <h5 class="room-title">{{ room }}</h5>
              </div>
              <div class="sessions-container">
                {% for session in sessions %}
                <div class="session-item {{ session.category }}">
                  <div class="session-content">
                    <div class="session-title">{{ session.title }}</div>
                    <div class="session-time">{{ session.time }}</div>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
          {% endfor %}
        </div>
      </div>
      {% endfor %}
    </div>

    {% else %}
    <div class="alert alert-warning border-0 shadow-sm text-center">
      <i class="fa-solid fa-exclamation-triangle me-2"></i>
      No schedule data available. Please check back later.
    </div>
    {% endif %}
  </div>
</section>

<style>
/* Tab Navigation */
.tab-navigation {
  margin-bottom: 2rem;
}

.tab-btn {
  background-color: #f8f9fa;
  border: 1px solid #e0e0e0;
  color: #666;
  padding: 12px 24px;
  border-radius: 8px;
  font-weight: 500;
  font-size: 14px;
  cursor: pointer;
  transition: all 0.3s ease;
  white-space: nowrap;
  margin: 0 6px;
}

.tab-btn:hover {
  background-color: #e9ecef;
  border-color: #ccc;
}

.tab-btn.active {
  background-color: #4a5568;
  color: white;
  border-color: #4a5568;
}

/* Legend */
.legend {
  margin-bottom: 2rem;
  padding: 1rem;
  background-color: #f8f9fa;
  border-radius: 8px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-right: 16px;
}

.legend-dot {
  width: 16px;
  height: 16px;
  border-radius: 50%;
  display: inline-block;
}

.legend-text {
  font-size: 13px;
  color: #666;
}

/* Tab Content */
.tab-content-wrapper {
  min-height: 500px;
}

.tab-content {
  display: none;
  animation: fadeIn 0.3s ease-in-out;
}

.tab-content.active {
  display: block;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Room Layout */
.room-column {
  background: white;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  overflow: hidden;
  height: 100%;
}

.room-header {
  background-color: #f8f9fa;
  padding: 1rem;
  border-bottom: 1px solid #e0e0e0;
  text-align: center;
}

.room-title {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
  color: #333;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.sessions-container {
  padding: 0;
}

/* Session Items */
.session-item {
  padding: 1rem;
  border-bottom: 1px solid #f0f0f0;
  transition: all 0.2s ease;
  cursor: pointer;
}

.session-item:last-child {
  border-bottom: none;
}

.session-item:hover {
  background-color: #f8f9fa;
  transform: translateX(2px);
}

.session-content {
  width: 100%;
}

.session-title {
  font-size: 14px;
  font-weight: 500;
  color: #333;
  margin-bottom: 4px;
  line-height: 1.3;
}

.session-time {
  font-size: 12px;
  color: #666;
  font-weight: 400;
}

/* Category Colors */
.session-item.break { background-color: #f7f7f7; border-left: 4px solid #d1d5db; }
.session-item.django-girls { background-color: #fef3c7; border-left: 4px solid #f59e0b; }
.session-item.community { background-color: #dcfce7; border-left: 4px solid #22c55e; }
.session-item.pyladies { background-color: #1e293b; border-left: 4px solid #0f172a; }
.session-item.pyladies .session-title,
.session-item.pyladies .session-time { color: white; }
.session-item.pydata { background-color: #f3e8ff; border-left: 4px solid #a855f7; }
.session-item.open-source { background-color: #fef2f2; border-left: 4px solid #ef4444; }
.session-item.keynote { background-color: #dbeafe; border-left: 4px solid #3b82f6; }
.session-item.talk { background-color: #ffffff; border-left: 4px solid #6b7280; }
.session-item.workshop { background-color: #ecfdf5; border-left: 4px solid #10b981; }
.session-item.networking { background-color: #fdf4ff; border-left: 4px solid #c084fc; }
.session-item.lightning { background-color: #fffbeb; border-left: 4px solid #f59e0b; }
.session-item.logistics { background-color: #f9fafb; border-left: 4px solid #9ca3af; }
.session-item.ceremony { background-color: #fef7ff; border-left: 4px solid #d946ef; }
.session-item.showcase { background-color: #f0f9ff; border-left: 4px solid #0ea5e9; }
.session-item.startup { background-color: #fff7ed; border-left: 4px solid #ea580c; }
.session-item.social { background-color: #fefce8; border-left: 4px solid #eab308; }

/* Legend dots colors */
.legend-dot.break { background-color: #d1d5db; }
.legend-dot.django-girls { background-color: #f59e0b; }
.legend-dot.community { background-color: #22c55e; }
.legend-dot.pyladies { background-color: #0f172a; }
.legend-dot.pydata { background-color: #a855f7; }
.legend-dot.open-source { background-color: #ef4444; }

/* Responsive Design */
@media (max-width: 768px) {
  .tab-btn {
    padding: 10px 16px;
    font-size: 13px;
    margin-bottom: 8px;
  }

  .room-title {
    font-size: 13px;
  }

  .session-title {
    font-size: 13px;
  }

  .session-time {
    font-size: 11px;
  }

  .legend {
    padding: 0.75rem;
  }

  .legend-item {
    flex-wrap: wrap;
    gap: 4px;
  }

  .legend-text {
    font-size: 12px;
  }
}

@media (max-width: 576px) {
  .col-lg-4 {
    margin-bottom: 1rem;
  }

  .session-item:hover {
    transform: none;
  }
}
</style>

<script>
function switchTab(tabId) {
  const allTabContents = document.querySelectorAll('.tab-content');
  allTabContents.forEach(content => content.classList.remove('active'));
  const allTabButtons = document.querySelectorAll('.tab-btn');
  allTabButtons.forEach(btn => btn.classList.remove('active'));
  const selectedTabContent = document.getElementById(tabId + '-content');
  if (selectedTabContent) selectedTabContent.classList.add('active');
  const selectedButton = document.querySelector(`[data-tab="${tabId}"]`);
  if (selectedButton) selectedButton.classList.add('active');
}

document.addEventListener('DOMContentLoaded', function() {
  document.addEventListener('keydown', function(e) {
    if (e.key === 'ArrowLeft' || e.key === 'ArrowRight') {
      const activeButton = document.querySelector('.tab-btn.active');
      const allButtons = [...document.querySelectorAll('.tab-btn')];
      const currentIndex = allButtons.indexOf(activeButton);
      let newIndex = e.key === 'ArrowLeft'
        ? (currentIndex > 0 ? currentIndex - 1 : allButtons.length - 1)
        : (currentIndex < allButtons.length - 1 ? currentIndex + 1 : 0);
      const newButton = allButtons[newIndex];
      if (newButton) {
        newButton.click();
        newButton.focus();
      }
    }
  });
});
</script>

{% endblock %}